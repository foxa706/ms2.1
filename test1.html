<!DOCTYPE HTML>
<html>
        <head>
    <title>Smellfie Quiz</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

    <script type="text/javascript" src="js/jq.js"></script>
    <script type="text/javascript" src="js/sb-1.4.1.js"></script>
    <script type="text/javascript">

        $(window).on("load", setup);

        // Spacebrew Object
        var sb
            , app_name = "Smellfie"
            ;

        /**
         * setup Configure spacebrew connection and adds the mousedown listener.
         */
        function setup (){
            var random_id = "0000" + Math.floor(Math.random() * 10000)
                ;

            app_name = app_name + ' ' + random_id.substring(random_id.length-4);

            // create spacebrew client object
            sb = new Spacebrew.Client({reconnect:true});

            // set the base description
            sb.name(app_name);
            sb.description("Description here.");

            // configure the publication and subscription feeds
            sb.addPublish( "sendQuiz", "boolean", "false" );
            sb.addSubscribe( "quizResult", "boolean" );

            // override Spacebrew events - this is how you catch events coming from Spacebrew
            sb.onBooleanMessage = onBooleanMessage;
            sb.onOpen = onOpen;

            // connect to spacbrew
            sb.connect();

            // listen to the mouse
            $("#submitQuiz").on("mousedown", onButtonPress);
            $("#submitQuiz").on("mouseup", onButtonRelease);
        }

        /**
         * Function that is called when Spacebrew connection is established
         */
        function onOpen() {
            var message = "Connected as <strong>" + sb.name() + "</strong>. ";
            if (sb.name() === app_name) {
                message += "<br>You can customize this app's name in the query string by adding <strong>name=your_app_name</strong>."
            }
            $("#name").html( message );
        }

        /**
         * Function that is called whenever the button is pressed.
         * @param  {Event object} evt Holds information about the button press event
         */
        function onButtonPress (evt){
                console.log("[onButtonPress] button has been pressed");
            sb.send("sendQuiz", "boolean", "true");
        }

        /**
         * Function that is called whenever the button is released.
         * @param  {Event object} evt Holds information about the button press event
         */
        function onButtonRelease (evt){
            console.log("[onButtonRelease] button has been released");
            sb.send("sendQuiz", "boolean", "false");
        }

        /**
         * onBooleanMessage Function that is called whenever new spacebrew boolean messages are received.
         *          It accepts two parameters:
         * @param  {String} name    Holds name of the subscription feed channel
         * @param  {Boolean} value  Holds value received from the subscription feed
         */
        function onBooleanMessage( name, value ){
            console.log("[onBooleanMessage] boolean message received ", value);
            if (value) {
                document.body.style.background = "rgb(100,255,100)";
            } else {
                document.body.style.background = "rgb(220,220,220)";
            }
        }

    </script>

</head>
<body>
    <div id="titleBox">
        <h1 id = "title">Smellfie Quiz</h1>
    </div>

    <div class="questionContainer">
        <h2 class= "question">Pick an Emoji</h2>
        <div class= "answerGrid">

            <div class="box" id = "a1">
<!--                <img src='http://s18.postimg.org/a9b93b46d/cactus.png' border='0' alt="cactus" /> -->
            </div>
            <div class="box" id = "a2"></div>
            <div class="box" id = "a3"></div>
            <div class="box" id = "a4"></div>

        </div>

        <div id="buttonBox">
                <a class="button" id="submitQuiz">Submit</a>
        </div>

    </div>
    <script type="text/javascript">

        var quizAnswerArray = [];
        var selected1 = false;
        var selected2 = false;
        var selected3 = false;
        var selected4 = false;

        var saveAnswer = function(ans){

            quizAnswerArray.push(ans);
            console.log("answers: " + quizAnswerArray);
        }

        var removeAnswer = function(){
            quizAnswerArray.splice(quizAnswerArray, 2);
        }

        $("#a1").click(function(){
            selected1 =! selected1;

        if(selected1){
            $(this).css({"border" : "solid 2px blue"});
            var ans = "x";
            console.log("answered: " + ans);
            saveAnswer(ans);

        }else{
            $(this).css({"border" : "solid 1px black"});
            console.log("undo");
            removeAnswer();
            }
        });

        $("#a2").click(function(){
            selected2 =! selected2;

        if(selected2){
            $(this).css({"border" : "solid 2px blue"});
            var ans = "X";
            console.log("answered: " + ans);
            saveAnswer(ans);

        }else{
            $(this).css({"border" : "solid 1px black"});
            console.log("undo");
            removeAnswer();
            }
        });

        $("#a3").click(function(){
            selected3 =! selected3;

        if(selected3){
            $(this).css({"border" : "solid 2px blue"});
            var ans = "Y";
            console.log("answered: " + ans);
            saveAnswer(ans);

        }else{
            $(this).css({"border" : "solid 1px black"});
            console.log("undo");
            removeAnswer();
            }
        });

        $("#a4").click(function(){
            selected4 =! selected4;

        if(selected4){
            $(this).css({"border" : "solid 2px blue"});
            var ans = "y";
            console.log("answered: " + ans);
            saveAnswer(ans);

        }else{
            $(this).css({"border" : "solid 1px black"});
            console.log("undo");
            removeAnswer();
            }
        });
        $("#submitQuiz").click(function(){
            console.log( 'Quiz submitted' );
        });

    </script>
</body>
</html>